<!-- Posts Grid -->
<div *ngIf="!loading" class="posts-grid">
  <article *ngFor="let post of posts" class="post-card" (click)="navigateToBlogDetail(post._id)">
    <!-- Post Header with Image and Title in the same row -->
    <div class="post-header">
      <div class="post-image-container" *ngIf="getImageUrl(post.main_image_url)">
        <img [src]="getImageUrl(post.main_image_url)" [alt]="post.title" class="post-image" loading="lazy" />
      </div>
      <div class="post-image-placeholder" *ngIf="!getImageUrl(post.main_image_url)"></div>
      <h2 class="post-title">{{ post.title }}</h2>
    </div>

    <!-- Post Content -->
    <div class="post-content">
      <!-- Tags -->
      <div class="post-tags" *ngIf="post.tags && post.tags.length > 0">
        <span *ngFor="let tag of getTagNames(post.tags).slice(0, 3)" class="post-tag"
          (click)="onTagClick(tag); $event.stopPropagation()">
          {{ tag }}
        </span>
      </div>

      <!-- Post Meta -->
      <div class="post-meta">
        <div class="post-author">
          <img *ngIf="getImageUrl(post.user?.profile_picture)" [src]="getImageUrl(post.user?.profile_picture)"
            [alt]="post.user?.username || post.username" class="author-avatar" />
          <div *ngIf="!getImageUrl(post.user?.profile_picture)" class="author-avatar-placeholder">
            {{ getFirstName(post.username || 'U').charAt(0).toUpperCase() }}
          </div>
          <span class="author-name">{{ getFirstName(post.username) }}</span>
        </div>

        <div class="post-dates">
          <span class="post-date">Created: {{ post.created_at | dateFormat }}</span>
          <span class="post-date" *ngIf="post.updated_at && post.updated_at !== post.created_at">
            Updated: {{ post.updated_at | dateFormat }}
          </span>
        </div>

        <div class="post-stats">
          <span class="stat">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd"
                d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"
                clip-rule="evenodd" />
            </svg>
            {{ post.likes_count }}
          </span>
          <span class="stat">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none">
              <path fill-rule="evenodd"
                d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z"
                clip-rule="evenodd" fill="currentColor" />
            </svg>
            {{ post.comment_count }}
          </span>
        </div>
      </div>
    </div>
  </article>
</div>

<!-- Empty State -->
<div *ngIf="!loading && posts.length === 0" class="empty-state">
  <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
    <path d="M9 12l2 2 4-4M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round" />
  </svg>
  <h3>No posts found</h3>
  <p>{{ searchQuery ? 'No posts match your search criteria.' : 'No blog posts available at the moment.' }}</p>
</div>

