<!-- Blog Home Page -->
<div class="blog-home">
  <!-- Header Section -->
  <header class="blog-header">
    <div class="header-container">
      <!-- Left Side: Brand + Search -->
      <div class="header-left">
        <div class="brand-section">
          <div class="brand-logo">
            <svg width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect width="48" height="48" rx="12" fill="url(#gradient)" />
              <path d="M16 18h16M16 24h12M16 30h8" stroke="white" stroke-width="2" stroke-linecap="round" />
              <defs>
                <linearGradient id="gradient" x1="0" y1="0" x2="48" y2="48" gradientUnits="userSpaceOnUse">
                  <stop stop-color="#667eea" />
                  <stop offset="1" stop-color="#764ba2" />
                </linearGradient>
              </defs>
            </svg>
          </div>
          <h1 class="brand-title">BlogPlatform</h1>

        </div>

        <!-- Search Bar -->
        <div class="search-container">
          <div class="search-input-wrapper">
            <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M17.5 17.5l-5.5-5.5M14 8a6 6 0 11-12 0 6 6 0 0112 0z" stroke="currentColor" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <input type="text" class="search-input" placeholder="Search blogs..." [(ngModel)]="searchQuery"
              (input)="onSearchInput(searchQuery)" />
          </div>
        </div>
      </div>

      <!-- Right Side: Action Buttons -->
      <div class="header-right">
        <div class="action-buttons" *ngIf="isAuthenticated">
          <button class="action-btn write-btn" routerLink="/posts/write">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
              <path
                d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"
                fill="currentColor" />
            </svg>
            Write
          </button>
          <button class="action-btn" routerLink="/posts">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
              <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" fill="currentColor" />
              <path fill-rule="evenodd"
                d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm2.5 3a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"
                clip-rule="evenodd" fill="currentColor" />
            </svg>
            My Blogs
          </button>

          <!-- Profile Button (Desktop) -->
          <div class="profile-dropdown desktop-profile" (click)="toggleUserMenu($event)">
            <button class="profile-btn" [class.active]="isUserMenuOpen">
              <img [src]="currentUser?.profile_picture || getDefaultAvatar()" [alt]="currentUser?.username || 'User'"
                class="profile-avatar" (error)="handleAvatarError($event)" />
              <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 20 20" fill="none"
                [class.rotated]="isUserMenuOpen">
                <path d="M5 7.5l5 5 5-5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </button>

            <!-- Profile Dropdown Menu -->
            <div class="profile-menu" *ngIf="isUserMenuOpen">
              <a routerLink="/profile" class="profile-menu-item" (click)="closeUserMenu()">
                View Profile
              </a>
              <button class="profile-menu-item logout-item" (click)="logout()">
                Sign Out
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Layout -->
      <div class="mobile-layout" *ngIf="isAuthenticated">
        <!-- Mobile Row 1: Brand Only -->
        <div class="mobile-brand-row">
          <div class="mobile-brand-section">
            <div class="brand-logo">
              <svg width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="48" height="48" rx="12" fill="url(#gradient-mobile)" />
                <path d="M16 18h16M16 24h12M16 30h8" stroke="white" stroke-width="2" stroke-linecap="round" />
                <defs>
                  <linearGradient id="gradient-mobile" x1="0" y1="0" x2="48" y2="48" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#667eea" />
                    <stop offset="1" stop-color="#764ba2" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
            <h1 class="brand-title">BlogPlatform</h1>
          </div>
        </div>

        <!-- Mobile Row 2: Search Bar -->
        <div class="mobile-search-row">
          <div class="search-container">
            <div class="search-input-wrapper">
              <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M17.5 17.5l-5.5-5.5M14 8a6 6 0 11-12 0 6 6 0 0112 0z" stroke="currentColor" stroke-width="1.5"
                  stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <input type="text" class="search-input" placeholder="Search blogs..." [(ngModel)]="searchQuery"
                (input)="onSearchInput(searchQuery)" />
            </div>
          </div>
        </div>

        <!-- Mobile Row 3: Action Buttons -->
        <div class="mobile-buttons-row">
          <button class="action-btn write-btn mobile-action-btn" routerLink="/posts/write">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
              <path
                d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"
                fill="currentColor" />
            </svg>
            Write
          </button>
          <button class="action-btn mobile-action-btn" routerLink="/posts">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
              <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" fill="currentColor" />
              <path fill-rule="evenodd"
                d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm2.5 3a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"
                clip-rule="evenodd" fill="currentColor" />
            </svg>
            My Blogs
          </button>
          
          <!-- Mobile Profile Button -->
          <div class="profile-dropdown mobile-profile" (click)="toggleUserMenu($event)">
            <button class="profile-btn mobile-profile-btn" [class.active]="isUserMenuOpen">
              <img [src]="currentUser?.profile_picture || getDefaultAvatar()" [alt]="currentUser?.username || 'User'"
                class="profile-avatar" (error)="handleAvatarError($event)" />
              <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 20 20" fill="none"
                [class.rotated]="isUserMenuOpen">
                <path d="M5 7.5l5 5 5-5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </button>

            <!-- Profile Dropdown Menu -->
            <div class="profile-menu" *ngIf="isUserMenuOpen">
              <a routerLink="/profile" class="profile-menu-item" (click)="closeUserMenu()">
                View Profile
              </a>
              <button class="profile-menu-item logout-item" (click)="logout()">
                Sign Out
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="content-container">
      <!-- Blog Posts Section (70%) -->
      <section class="posts-section">
        <!-- Top Pagination -->
        <div class="pagination-wrapper">
          <app-pagination 
            [loading]="loading"
            [posts]="posts"
            [currentPage]="currentPage"
            [totalPages]="totalPages"
            (pageChange)="onPageChange($event)">
          </app-pagination>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="loading-container">
          <div class="loading-spinner"></div>
          <p class="loading-text">Loading posts...</p>
        </div>

        <!-- Blog List Component -->
        <app-blog-list 
          [posts]="posts" 
          [loading]="loading" 
          [searchQuery]="searchQuery"
          (tagClick)="onTagClick($event)">
        </app-blog-list>

        <!-- Pagination -->
        <div class="pagination-wrapper">
          <app-pagination 
            [loading]="loading"
            [posts]="posts"
            [currentPage]="currentPage"
            [totalPages]="totalPages"
            (pageChange)="onPageChange($event)">
          </app-pagination>
        </div>
        
      </section>

      <!-- Recommended Tags Section (30%) -->
      <aside class="tags-sidebar">
        <div class="sidebar-section">
          <h3 class="sidebar-title">Recommended Tags</h3>

          <div class="tags-container">
            <button *ngFor="let tag of recommendedTags" class="tag-button" (click)="onTagClick(tag)">
              {{ tag }}
            </button>
          </div>

          <div *ngIf="recommendedTags.length === 0" class="empty-tags">
            <p>No tags available</p>
          </div>
        </div>
      </aside>
    </div>
  </main>
</div>

<app-interest-popup 
  [isAuthenticated]="isAuthenticated" 
  (popupClosed)="closeInterestsPopup()" 
  (interestsSetupCompleted)="onInterestsSetupCompleted()" 
  (interestsSkipped)="onSkipInterests()"
>
</app-interest-popup>
<app-footer></app-footer>